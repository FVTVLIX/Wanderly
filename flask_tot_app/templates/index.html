<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wanderly | AI Travel Planner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="top-nav">
        <div class="nav-container">
            <a href="{{ url_for('index') }}" class="nav-logo">WANDERLY</a>
            <div class="nav-links">
                <a href="{{ url_for('index') }}">New Search</a>
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('profile') }}">My Profile</a>
                <a href="{{ url_for('logout') }}">Logout</a>
                {% else %}
                <a href="{{ url_for('login') }}">Login</a>
                <a href="{{ url_for('register') }}">Sign Up</a>
                {% endif %}
                <button id="darkModeToggle" class="btn-secondary-sm"
                    style="border-radius: 50%; width: 32px; height: 32px; padding: 0; display: flex; align-items: center; justify-content: center;">
                    <i class="fa-solid fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <h1 class="hero-title">WHERE DREAMS BECOME JOURNEYS</h1>
            <p class="hero-subtitle">Experience the world with AI-curated travel strategies designed just for you.</p>

            <form action="{{ url_for('analyze') }}" method="POST" class="hero-search-form" id="searchForm">
                <div class="input-wrapper" style="flex-direction: column; gap: 0;">
                    <div style="display: flex; width: 100%; border-bottom: 2px solid #000;">
                        <i class="fa-solid fa-location-dot search-icon" style="padding-top: 1.5rem;"></i>
                        <input type="text" name="origin" placeholder="Where are you starting from? (Optional)"
                            autocomplete="off">
                    </div>
                    <div style="display: flex; width: 100%;">
                        <i class="fa-solid fa-magnifying-glass search-icon"
                            style="padding-top: 1.5rem; align-self: flex-start;"></i>
                        <textarea name="query" placeholder="Where do you want to go?" required
                            style="flex: 1; padding: 1.5rem; border: none; outline: none; font-family: var(--font-body); font-size: 1.1rem; font-weight: 600; background: transparent; resize: none; min-height: 100px;"></textarea>
                        <button type="submit" class="btn-search" style="height: auto;">
                            Let's Go <i class="fa-solid fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
        </div>
        </form>

        <div class="hero-tags">
            <span
                style="background: #000; color: #FFF; padding: 0.2rem 0.5rem; transform: rotate(-2deg);">Trending:</span>
            {% for item in trending %}
            <button type="button" onclick="fillSearch('{{ item.query }}')">{{ item.label }}</button>
            {% endfor %}
        </div>
        </div>
    </section>

    <!-- App Details Section -->
    <section class="container" style="margin-bottom: 4rem;">
        <div class="info-card" style="transform: rotate(-1deg); margin-bottom: 3rem;">
            <h2 style="text-align: center; margin-bottom: 1rem;">Why Wanderly?</h2>
            <p style="font-size: 1.1rem; text-align: center; max-width: 800px; margin: 0 auto;">
                Wanderly isn't just another travel planner. It's your personal AI travel agent that understands your
                vibe.
                Whether you're a foodie hunting for the best street eats in Osaka, a history buff exploring Rome's
                ruins,
                or an adventurer seeking Iceland's hidden waterfalls, Wanderly crafts the perfect itinerary for you.
            </p>
        </div>

        <div class="strategies-grid" style="margin-bottom: 3rem;">
            <div class="info-card" style="background: var(--accent-2); transform: rotate(1deg);">
                <h3 style="margin-bottom: 0.5rem;"><i class="fa-solid fa-robot"></i> AI-Powered</h3>
                <p>We use advanced AI models to generate unique, non-generic travel strategies tailored to your specific
                    interests and budget.</p>
            </div>
            <div class="info-card" style="background: var(--accent-3); transform: rotate(-1deg);">
                <h3 style="margin-bottom: 0.5rem;"><i class="fa-solid fa-wallet"></i> Budget Smart</h3>
                <p>Get realistic cost breakdowns for flights, lodging, food, and activities so you can plan without
                    breaking the bank.</p>
            </div>
            <div class="info-card" style="background: var(--accent-4); transform: rotate(1deg);">
                <h3 style="margin-bottom: 0.5rem;"><i class="fa-solid fa-map-location-dot"></i> Visual Itineraries</h3>
                <p>Visualize your trip with interactive maps and day-by-day breakdowns that make navigation a breeze.
                </p>
            </div>
        </div>

        <div class="info-card" style="background: #FFF; border: 3px dashed #000; padding: 2rem;">
            <div style="text-align: center; margin-bottom: 1.5rem;">
                <h3 style="font-size: 2rem;"><i class="fa-solid fa-key"></i> Bring Your Own Keys</h3>
                <p style="font-size: 1.1rem; margin-top: 0.5rem;">To unlock the full power of Wanderly, create an
                    account and add your own API keys.</p>
            </div>

            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                <div style="text-align: center;">
                    <i class="fa-brands fa-google" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                    <h4 style="margin-bottom: 0.5rem;">Google Gemini</h4>
                    <p>Fast, efficient, and great for quick itinerary generation.</p>
                </div>
                <div style="text-align: center;">
                    <i class="fa-solid fa-bolt" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                    <h4 style="margin-bottom: 0.5rem;">OpenAI GPT-4</h4>
                    <p>Deep reasoning for complex, multi-city trips and detailed history.</p>
                </div>
                <div style="text-align: center;">
                    <i class="fa-solid fa-brain" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                    <h4 style="margin-bottom: 0.5rem;">Anthropic Claude</h4>
                    <p>Natural, creative, and human-like travel suggestions.</p>
                </div>
            </div>

            {% if not current_user.is_authenticated %}
            <div style="text-align: center;">
                <a href="{{ url_for('register') }}" class="btn-primary">Create Free Account</a>
                <p style="margin-top: 1rem; font-size: 0.9rem;">Already have an account? <a
                        href="{{ url_for('login') }}" style="text-decoration: underline; font-weight: 700;">Login
                        here</a>.</p>
            </div>
            {% else %}
            <div style="text-align: center;">
                <a href="{{ url_for('settings') }}" class="btn-primary">Manage API Keys</a>
            </div>
            {% endif %}
        </div>
    </section>

    <!-- How It Works -->
    <section class="container" style="margin-bottom: 6rem;">
        <div class="section-header" style="text-align: center; margin-bottom: 4rem;">
            <h2 style="font-size: 3rem; transform: rotate(-1deg);">How It Works</h2>
        </div>
        <div class="steps-grid">
            <div class="step-card" style="background: var(--accent-1);">
                <div class="step-number">1</div>
                <h3 style="margin-top: 1.5rem; margin-bottom: 1rem;">Dream It</h3>
                <p>Tell us where you want to go, or just give us a vibe. "Sushi in Tokyo" or "Relaxing in Bali".</p>
            </div>
            <div class="step-card" style="background: var(--accent-2);">
                <div class="step-number">2</div>
                <h3 style="margin-top: 1.5rem; margin-bottom: 1rem;">Plan It</h3>
                <p>Our AI agents compete to build the perfect itinerary, complete with costs and hidden gems.</p>
            </div>
            <div class="step-card" style="background: var(--accent-3);">
                <div class="step-number">3</div>
                <h3 style="margin-top: 1.5rem; margin-bottom: 1rem;">Live It</h3>
                <p>Save your strategy, sync it to your calendar (coming soon!), and start your adventure.</p>
            </div>
        </div>
    </section>

    <!-- Reviews -->
    <section class="container" style="margin-bottom: 6rem;">
        <div class="section-header" style="text-align: center; margin-bottom: 4rem;">
            <h2 style="font-size: 3rem; transform: rotate(1deg);">Love from Travelers</h2>
        </div>
        <div class="testimonials-grid">
            <div class="testimonial-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div class="user-avatar" style="background: #FF6B6B;"></div>
                    <div>
                        <h4 style="margin-bottom: 0;">Sarah J.</h4>
                        <div style="color: #FFD700;">★★★★★</div>
                    </div>
                </div>
                <p>"Wanderly found a ramen shop in Osaka that wasn't on any other blog. It was life-changing!"</p>
            </div>
            <div class="testimonial-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div class="user-avatar" style="background: #4ECDC4;"></div>
                    <div>
                        <h4 style="margin-bottom: 0;">Mike T.</h4>
                        <div style="color: #FFD700;">★★★★★</div>
                    </div>
                </div>
                <p>"I planned a 2-week Patagonia trip in 5 minutes. The cost breakdown was surprisingly accurate."</p>
            </div>
            <div class="testimonial-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div class="user-avatar" style="background: #FFE66D;"></div>
                    <div>
                        <h4 style="margin-bottom: 0;">Jessica L.</h4>
                        <div style="color: #FFD700;">★★★★★</div>
                    </div>
                </div>
                <p>"Finally, an AI that understands 'budget-friendly' doesn't mean 'boring'. Highly recommend!"</p>
            </div>
        </div>
    </section>

    <!-- Pricing -->
    <section class="container" style="margin-bottom: 6rem;">
        <div class="section-header" style="text-align: center; margin-bottom: 4rem;">
            <h2 style="font-size: 3rem; transform: rotate(-1deg);">Travel Your Way</h2>
        </div>
        <div class="pricing-grid">
            <div class="pricing-card">
                <h3>Day Tripper</h3>
                <div class="price-tag">$0<span class="price-period">/mo</span></div>
                <p style="margin-bottom: 2rem;">Perfect for the occasional explorer.</p>
                <ul class="feature-list">
                    <li>3 AI Searches per day</li>
                    <li>Basic Itineraries</li>
                    <li>Save up to 5 trips</li>
                </ul>
                <a href="{{ url_for('register') }}" class="btn-secondary-sm"
                    style="width: 100%; text-align: center;">Get Started</a>
            </div>
            <div class="pricing-card featured" style="background: var(--accent-4);">
                <div
                    style="position: absolute; top: -1rem; right: -1rem; background: #000; color: #FFF; padding: 0.5rem 1rem; transform: rotate(5deg); font-weight: 700; font-family: var(--font-display);">
                    BEST VALUE</div>
                <h3>Globetrotter</h3>
                <div class="price-tag">$9<span class="price-period">/mo</span></div>
                <p style="margin-bottom: 2rem;">For the serious wanderluster.</p>
                <ul class="feature-list">
                    <li>Unlimited Searches</li>
                    <li>Advanced AI Models (GPT-4)</li>
                    <li>Detailed Cost Breakdowns</li>
                    <li>Priority Support</li>
                </ul>
                <a href="{{ url_for('register') }}" class="btn-primary" style="width: 100%; text-align: center;">Go
                    Pro</a>
            </div>
            <div class="pricing-card">
                <h3>Nomad</h3>
                <div class="price-tag">$29<span class="price-period">/mo</span></div>
                <p style="margin-bottom: 2rem;">For digital nomads and agencies.</p>
                <ul class="feature-list">
                    <li>Everything in Globetrotter</li>
                    <li>API Access</li>
                    <li>White-label Itineraries</li>
                    <li>Team Collaboration</li>
                </ul>
                <a href="#" class="btn-secondary-sm" style="width: 100%; text-align: center;">Contact Us</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div>
                <div class="footer-logo">WANDERLY</div>
                <p style="max-width: 300px; margin-top: 1rem; color: #aaa;">
                    Your AI-powered passport to the world's best kept secrets.
                </p>
            </div>
            <div class="footer-links">
                <a href="{{ url_for('index') }}" class="footer-link">Home</a>
                <a href="{{ url_for('profile') }}" class="footer-link">My Profile</a>
                <a href="{{ url_for('settings') }}" class="footer-link">Settings</a>
                <div class="footer-socials">
                    <a href="#" class="social-icon"><i class="fa-brands fa-twitter"></i></a>
                    <a href="#" class="social-icon"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#" class="social-icon"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="#" class="social-icon"><i class="fa-brands fa-github"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div>&copy; 2024 Wanderly AI. All rights reserved.</div>
            <div style="display: flex; gap: 1rem;">
                <a href="#" style="text-decoration: underline;">Privacy Policy</a>
                <a href="#" style="text-decoration: underline;">Terms of Service</a>
            </div>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loader-content">
            <div class="animation-container">
                <i class="fa-solid fa-earth-americas globe-icon"
                    style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);"></i>
                <div class="plane-orbit">
                    <i class="fa-solid fa-plane plane-icon"></i>
                </div>
            </div>
            <h3 class="loading-title" style="margin-top: 1rem; font-family: 'Anton', sans-serif; letter-spacing: 1px;">
                CRAFTING YOUR JOURNEY...</h3>

            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; font-weight: 700;">
                <span id="loadingStatus">Initializing...</span>
                <span id="loadingPercent">0%</span>
            </div>
            <div id="delayedMessage" class="hidden"
                style="margin-top: 1rem; font-style: italic; font-size: 0.9rem; color: #555; text-align: center;">
                (Wanderly is debating the best routes... please don't refresh!)
            </div>
        </div>
    </div>

    <script>
        // Dark Mode Logic
        const toggleBtn = document.getElementById('darkModeToggle');
        const body = document.body;
        const icon = toggleBtn.querySelector('i');

        // Check local storage
        if (localStorage.getItem('darkMode') === 'enabled') {
            body.classList.add('dark-mode');
            icon.classList.remove('fa-moon');
            icon.classList.add('fa-sun');
        }

        toggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');

            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                localStorage.setItem('darkMode', 'disabled');
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        });

        function fillSearch(text) {
            const input = document.querySelector('textarea[name="query"]');
            if (input) {
                input.value = text;
                input.focus();
            }
        }

        const form = document.getElementById('searchForm');
        if (form) {
            form.addEventListener('submit', function () {
                const overlay = document.getElementById('loadingOverlay');
                overlay.classList.remove('hidden');
                startLoadingAnimation();
            });
        }

        function startLoadingAnimation() {
            const progressBar = document.getElementById('progressBar');
            const statusText = document.getElementById('loadingStatus');
            const percentText = document.getElementById('loadingPercent');
            const delayedMessage = document.getElementById('delayedMessage');

            const messages = [
                "Packing virtual bags...",
                "Consulting travel spirits...",
                "Spinning the globe...",
                "Calculating fun coefficients...",
                "Bribing the pilot...",
                "Finding the best snacks...",
                "Checking weather patterns...",
                "Optimizing route for maximum joy..."
            ];

            let progress = 0;
            let messageIndex = 0;
            let lastProgress = 0;
            let stuckTicks = 0;

            // Define points where we intentionally stall to simulate "thinking"
            // [trigger_percent, stall_duration_ticks] (1 tick = 100ms)
            // Stall for 40 ticks (4s) at 35% and 75% to trigger the message
            let forcedStalls = [
                { at: 35, duration: 40, active: true },
                { at: 75, duration: 40, active: true }
            ];
            let currentStallTimer = 0;

            const interval = setInterval(() => {
                let shouldMove = true;

                // Check for forced stalls
                for (let stall of forcedStalls) {
                    if (stall.active && progress >= stall.at && progress < stall.at + 2) {
                        shouldMove = false;
                        currentStallTimer++;
                        if (currentStallTimer >= stall.duration) {
                            stall.active = false; // Stall complete
                            currentStallTimer = 0;
                        }
                        break;
                    }
                }

                // Cap at 95%
                if (progress >= 95) {
                    progress = 95;
                    shouldMove = false;
                }

                if (shouldMove) {
                    // Random increment
                    progress += Math.random() * 2 + 0.5;
                }

                // Update UI
                progressBar.style.width = `${progress}%`;
                percentText.textContent = `${Math.round(progress)}%`;

                // Message rotation
                if (Math.round(progress) % 15 === 0 && shouldMove) {
                    messageIndex = (messageIndex + 1) % messages.length;
                    statusText.textContent = messages[messageIndex];
                }

                // Stuck detection
                if (Math.abs(progress - lastProgress) < 0.1) {
                    stuckTicks++;
                } else {
                    stuckTicks = 0;
                    lastProgress = progress;
                    // Hide message if we start moving again
                    delayedMessage.classList.add('hidden');
                }

                // Show message if stuck for > 3 seconds (30 ticks)
                if (stuckTicks > 30) {
                    delayedMessage.classList.remove('hidden');
                }

            }, 100); // Update every 100ms
        }
    </script>
</body>

</html>